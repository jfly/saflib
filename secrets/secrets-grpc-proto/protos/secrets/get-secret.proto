syntax = "proto3";

package secrets_grpc_proto.secrets.v1;

import "envelope.proto";

message GetSecretRequest {
  saflib.common.v1.SafAuth auth = 1;
  saflib.common.v1.SafRequest request = 2;
  string secret_name = 3;
  string description = 4;
  string token = 5;
}

message GetSecretResponse {
  oneof result {
    GetSecretSuccess success = 1;
    GetSecretError error = 2;
  }
}

message GetSecretSuccess {
  string value = 1;
}

enum GetSecretError {
  GET_SECRET_INVALID_REQUEST = 0;
  GET_SECRET_INVALID_TOKEN = 1;
  GET_SECRET_TOKEN_NOT_APPROVED = 2;
  GET_SECRET_ACCESS_NOT_GRANTED = 3;
  GET_SECRET_NOT_FOUND = 4;
  GET_SECRET_VALUE_NOT_SET = 5;
  GET_SECRET_NOT_ACTIVE = 6;
  GET_SECRET_UNKNOWN_ERROR = 7;
}
