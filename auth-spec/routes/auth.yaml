resend-verification:
  post:
    summary: "Resend Verification Email"
    operationId: resendVerification
    tags:
      - auth
    responses:
      "200":
        description: Verification email sent successfully
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResendVerificationResponse"
      "401":
        description: User not logged in
        content:
          application/json:
            schema:
              $ref: "../schemas/error.yaml"

set-password:
  post:
    summary: "Change User Password"
    operationId: setPassword
    tags:
      - auth
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/SetPasswordRequest"
    responses:
      "200":
        description: Password changed successfully
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SetPasswordResponse"
      "401":
        description: User not logged in or invalid current password
        content:
          application/json:
            schema:
              $ref: "../schemas/error.yaml"

components:
  schemas:
    ResendVerificationResponse:
      type: object
      required:
        - success
        - message
      additionalProperties: false
      properties:
        success:
          type: boolean
        message:
          type: string
          description: A generic message indicating that the verification email was sent

    SetPasswordRequest:
      type: object
      required:
        - currentPassword
        - newPassword
      additionalProperties: false
      properties:
        currentPassword:
          type: string
          description: The user's current password for verification
        newPassword:
          type: string
          minLength: 8
          description: The new password to set

    SetPasswordResponse:
      type: object
      required:
        - success
      additionalProperties: false
      properties:
        success:
          type: boolean
