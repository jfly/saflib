# syntax=docker/dockerfile:labs
FROM node:alpine3.19

WORKDIR /app

COPY --parents ./package.json ./package-lock.json ./saflib/node_modules/@colors/colors/package.json ./saflib/node_modules/@dabh/diagnostics/package.json ./saflib/node_modules/@drizzle-team/brocli/package.json ./saflib/node_modules/@esbuild-kit/core-utils/package.json ./saflib/node_modules/@esbuild-kit/esm-loader/package.json ./saflib/node_modules/@opentelemetry/api/package.json ./saflib/node_modules/@protobufjs/aspromise/package.json ./saflib/node_modules/@protobufjs/base64/package.json ./saflib/node_modules/@protobufjs/codegen/package.json ./saflib/node_modules/@protobufjs/eventemitter/package.json ./saflib/node_modules/@protobufjs/fetch/package.json ./saflib/node_modules/@protobufjs/float/package.json ./saflib/node_modules/@protobufjs/inquire/package.json ./saflib/node_modules/@protobufjs/path/package.json ./saflib/node_modules/@protobufjs/pool/package.json ./saflib/node_modules/@protobufjs/utf8/package.json ./saflib/cron/cron-db/package.json ./saflib/cron/cron-service/package.json ./saflib/cron/cron-spec/package.json ./saflib/node_modules/@saflib/drizzle-sqlite3/package.json ./saflib/node_modules/@saflib/env/package.json ./saflib/node_modules/@saflib/monorepo/package.json ./saflib/node_modules/@saflib/node/package.json ./saflib/node_modules/@saflib/openapi/package.json ./saflib/node_modules/@types/node/package.json ./saflib/node_modules/@types/triple-beam/package.json ./saflib/node_modules/@eslint/eslintrc/node_modules/ajv/package.json ./saflib/node_modules/async/package.json ./saflib/node_modules/async-exit-hook/package.json ./saflib/node_modules/base64-js/package.json ./saflib/node_modules/better-sqlite3/package.json ./saflib/node_modules/bindings/package.json ./saflib/node_modules/bintrees/package.json ./saflib/node_modules/bl/package.json ./saflib/node_modules/btoa/package.json ./saflib/node_modules/buffer/package.json ./saflib/node_modules/buffer-from/package.json ./saflib/node_modules/chownr/package.json ./saflib/node_modules/color/package.json ./saflib/node_modules/color/node_modules/color-convert/package.json ./saflib/node_modules/color/node_modules/color-name/package.json ./saflib/node_modules/color-string/package.json ./saflib/node_modules/colorspace/package.json ./saflib/node_modules/@vitest/coverage-v8/node_modules/debug/package.json ./saflib/node_modules/decompress-response/package.json ./saflib/node_modules/deep-extend/package.json ./saflib/node_modules/detect-libc/package.json ./saflib/node_modules/drizzle-kit/package.json ./saflib/node_modules/drizzle-orm/package.json ./saflib/node_modules/enabled/package.json ./saflib/node_modules/end-of-stream/package.json ./saflib/node_modules/@esbuild-kit/core-utils/node_modules/esbuild/package.json ./saflib/node_modules/esbuild-register/package.json ./saflib/node_modules/expand-template/package.json ./saflib/node_modules/fast-deep-equal/package.json ./saflib/node_modules/fast-json-stable-stringify/package.json ./saflib/node_modules/fecha/package.json ./saflib/node_modules/file-uri-to-path/package.json ./saflib/node_modules/fn.name/package.json ./saflib/node_modules/fs-constants/package.json ./saflib/node_modules/get-tsconfig/package.json ./saflib/node_modules/github-from-package/package.json ./saflib/node_modules/ieee754/package.json ./saflib/node_modules/inherits/package.json ./saflib/node_modules/ini/package.json ./saflib/node_modules/is-arrayish/package.json ./saflib/node_modules/is-stream/package.json ./saflib/node_modules/@eslint/eslintrc/node_modules/json-schema-traverse/package.json ./saflib/node_modules/kuler/package.json ./saflib/node_modules/logform/package.json ./saflib/node_modules/long/package.json ./saflib/node_modules/mimic-response/package.json ./saflib/node_modules/minimist/package.json ./saflib/node_modules/mkdirp-classic/package.json ./saflib/node_modules/@vitest/coverage-v8/node_modules/ms/package.json ./saflib/node_modules/napi-build-utils/package.json ./saflib/node_modules/node-abi/package.json ./saflib/node_modules/once/package.json ./saflib/node_modules/one-time/package.json ./saflib/node_modules/prebuild-install/package.json ./saflib/node_modules/prom-client/package.json ./saflib/node_modules/protobufjs/package.json ./saflib/node_modules/pump/package.json ./saflib/node_modules/punycode/package.json ./saflib/node_modules/rc/package.json ./saflib/node_modules/readable-stream/package.json ./saflib/node_modules/resolve-pkg-maps/package.json ./saflib/node_modules/compression/node_modules/safe-buffer/package.json ./saflib/node_modules/safe-stable-stringify/package.json ./saflib/node_modules/semver/package.json ./saflib/node_modules/simple-concat/package.json ./saflib/node_modules/simple-get/package.json ./saflib/node_modules/simple-swizzle/package.json ./saflib/node_modules/source-map/package.json ./saflib/node_modules/source-map-support/package.json ./saflib/node_modules/stack-trace/package.json ./saflib/node_modules/string_decoder/package.json ./saflib/node_modules/rc/node_modules/strip-json-comments/package.json ./saflib/node_modules/tar-fs/package.json ./saflib/node_modules/tar-stream/package.json ./saflib/node_modules/tdigest/package.json ./saflib/node_modules/text-hex/package.json ./saflib/node_modules/triple-beam/package.json ./saflib/node_modules/tunnel-agent/package.json ./saflib/node_modules/undici-types/package.json ./saflib/node_modules/uri-js/package.json ./saflib/node_modules/url-polyfill/package.json ./saflib/node_modules/util-deprecate/package.json ./saflib/node_modules/winston/package.json ./saflib/node_modules/winston-loki/package.json ./saflib/node_modules/winston-transport/package.json ./saflib/node_modules/wrappy/package.json ./
RUN npm install --omit=dev
COPY --parents ./saflib/node_modules/@colors/colors ./saflib/node_modules/@dabh/diagnostics ./saflib/node_modules/@drizzle-team/brocli ./saflib/node_modules/@esbuild-kit/core-utils ./saflib/node_modules/@esbuild-kit/esm-loader ./saflib/node_modules/@opentelemetry/api ./saflib/node_modules/@protobufjs/aspromise ./saflib/node_modules/@protobufjs/base64 ./saflib/node_modules/@protobufjs/codegen ./saflib/node_modules/@protobufjs/eventemitter ./saflib/node_modules/@protobufjs/fetch ./saflib/node_modules/@protobufjs/float ./saflib/node_modules/@protobufjs/inquire ./saflib/node_modules/@protobufjs/path ./saflib/node_modules/@protobufjs/pool ./saflib/node_modules/@protobufjs/utf8 ./saflib/cron/cron-db ./saflib/cron/cron-service ./saflib/cron/cron-spec ./saflib/node_modules/@saflib/drizzle-sqlite3 ./saflib/node_modules/@saflib/env ./saflib/node_modules/@saflib/monorepo ./saflib/node_modules/@saflib/node ./saflib/node_modules/@saflib/openapi ./saflib/node_modules/@types/node ./saflib/node_modules/@types/triple-beam ./saflib/node_modules/@eslint/eslintrc/node_modules/ajv ./saflib/node_modules/async ./saflib/node_modules/async-exit-hook ./saflib/node_modules/base64-js ./saflib/node_modules/better-sqlite3 ./saflib/node_modules/bindings ./saflib/node_modules/bintrees ./saflib/node_modules/bl ./saflib/node_modules/btoa ./saflib/node_modules/buffer ./saflib/node_modules/buffer-from ./saflib/node_modules/chownr ./saflib/node_modules/color ./saflib/node_modules/color/node_modules/color-convert ./saflib/node_modules/color/node_modules/color-name ./saflib/node_modules/color-string ./saflib/node_modules/colorspace ./saflib/node_modules/@vitest/coverage-v8/node_modules/debug ./saflib/node_modules/decompress-response ./saflib/node_modules/deep-extend ./saflib/node_modules/detect-libc ./saflib/node_modules/drizzle-kit ./saflib/node_modules/drizzle-orm ./saflib/node_modules/enabled ./saflib/node_modules/end-of-stream ./saflib/node_modules/@esbuild-kit/core-utils/node_modules/esbuild ./saflib/node_modules/esbuild-register ./saflib/node_modules/expand-template ./saflib/node_modules/fast-deep-equal ./saflib/node_modules/fast-json-stable-stringify ./saflib/node_modules/fecha ./saflib/node_modules/file-uri-to-path ./saflib/node_modules/fn.name ./saflib/node_modules/fs-constants ./saflib/node_modules/get-tsconfig ./saflib/node_modules/github-from-package ./saflib/node_modules/ieee754 ./saflib/node_modules/inherits ./saflib/node_modules/ini ./saflib/node_modules/is-arrayish ./saflib/node_modules/is-stream ./saflib/node_modules/@eslint/eslintrc/node_modules/json-schema-traverse ./saflib/node_modules/kuler ./saflib/node_modules/logform ./saflib/node_modules/long ./saflib/node_modules/mimic-response ./saflib/node_modules/minimist ./saflib/node_modules/mkdirp-classic ./saflib/node_modules/@vitest/coverage-v8/node_modules/ms ./saflib/node_modules/napi-build-utils ./saflib/node_modules/node-abi ./saflib/node_modules/once ./saflib/node_modules/one-time ./saflib/node_modules/prebuild-install ./saflib/node_modules/prom-client ./saflib/node_modules/protobufjs ./saflib/node_modules/pump ./saflib/node_modules/punycode ./saflib/node_modules/rc ./saflib/node_modules/readable-stream ./saflib/node_modules/resolve-pkg-maps ./saflib/node_modules/compression/node_modules/safe-buffer ./saflib/node_modules/safe-stable-stringify ./saflib/node_modules/semver ./saflib/node_modules/simple-concat ./saflib/node_modules/simple-get ./saflib/node_modules/simple-swizzle ./saflib/node_modules/source-map ./saflib/node_modules/source-map-support ./saflib/node_modules/stack-trace ./saflib/node_modules/string_decoder ./saflib/node_modules/rc/node_modules/strip-json-comments ./saflib/node_modules/tar-fs ./saflib/node_modules/tar-stream ./saflib/node_modules/tdigest ./saflib/node_modules/text-hex ./saflib/node_modules/triple-beam ./saflib/node_modules/tunnel-agent ./saflib/node_modules/undici-types ./saflib/node_modules/uri-js ./saflib/node_modules/url-polyfill ./saflib/node_modules/util-deprecate ./saflib/node_modules/winston ./saflib/node_modules/winston-loki ./saflib/node_modules/winston-transport ./saflib/node_modules/wrappy ./

WORKDIR /app/services/cron
CMD ["npm", "start"]